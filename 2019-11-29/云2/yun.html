<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="./css/css.css">
    <link rel="stylesheet" href="./css/reset.min.css.css">
</head>
<body>
    <div id="herd">
        <div class="herd-l">
            <a href=""><img src="./img/pcgames0422x1_thumb.jpg" alt=""></a>
            <div>
                <p>不经一番寒彻骨，怎得梅花扑鼻香</p>
                <p>How can you get a plum blossom without a blast of cold</p>
             </div>
        </div>
        
       <div class="herd-r">
            <p><img src="./img/移动到文件夹.png" alt=""> <span>全文搜索</span></p>
            <p><img src="./img/我的文档.png" alt=""> 我的文档</p>
            <p><img src="./img/微信图片_20191201163102.jpg" alt=""><span>倪大大</span> </p>
        </div>
        
    </div>
    <div id="gong">
        <ul class="heng-l">
            <li><img src="./img/下载.png" alt=""> <span>下载</span></li>
            <li><img src="./img/分享.png" alt=""> <span>分享</span></li>
            <li><img src="./img/移动到文件夹.png" alt=""> <span>移动到</span> </li>
            <li><img src="./img/重命名.png" alt=""> <span>重命名</span></li>
            <li><img src="./img/删除.png" alt=""> <span>删除</span></li>
            <li id="xinjian"><img src="./img/新建文件夹.png" alt=""> <span>新建</span></li>
            <li class="flash"><img src="./img/刷新.png" alt=""></li>
        </ul> 
        <ul class="heng-r">
            <li><img src="./img/ico_type.jpg" alt=""></li>
            <li><img src="./img/suolve.png" alt=""></li> 
        </ul> 
    </div>
    <div id="ret">
        <div id="wenjian"></div>
    </div>
    <div id="cai">
        
        <div class="dan">
            <ul class="caidan">
                <li><img src="./img/我的文档.png" alt=""> 微云</li>
                <li><img src="./img/我的文档.png" alt="">我的文档</li>
                <li><img src="./img/我的文档.png" alt="">我的音乐</li>
                <li><img src="./img/我的文档.png" alt="">微云</li>
                <li><img src="./img/我的文档.png" alt="">我的文档</li>
                <li>js程序设计</li>
                <li>js权威指南</li>
                <li><img src="./img/我的文档.png" alt="">我的音乐</li>
                <li><img src="./img/我的文档.png" alt="">周杰伦</li>
                <li>发如雪</li>
                <li>夜曲</li>
                <li>稻香</li>
                <li><img src="./img/我的文档.png" alt="">王杰</li>
                <li><img src="./img/我的文档.png" alt="">张国荣</li>
            </ul>
        </div>
    </div>
  <script src="./js/jquery.min.js"></script>
  <script>
        let ary = [
            {
                title:'新建文件夹',
                id:0
            },
            {
                title:'新建文件夹(1)',
                id:1
            }
        ];
        //select  全选 + 聚焦  表单的
        // 1.生成内容

        function render(arr){
            $('#ret').html('');
           
            
            $.each(arr,(i,item)=>{
                //创建文件夹
                let $folder = $(`
                <div class = "folder">
                    <img src="./img/文件夹.png">
                    <input type="text"/>
                    <p>${item.title}</p>
                    </div>
                    `);
                    $folder.find('input').hide();
                    $('#ret').append($folder);
            });
        }
        render(ary);
        /* 
            2.点击创建文件夹
            先在box中创建一个folder的元素。然后当folder中的input失焦之后再添加数据到ary中
            然后通过最新的ary渲染页面即可
        */
       $('#xinjian').click(function(){
            console.log(1);
           let $folder = $(`
           <div class="folder">
            <img src="./img/文件夹.png">
            <input type="text"
            placeholder="请设置文件名"
            value="新建文件夹"/>
            </div>
            `);
            $('#ret').append($folder);
            //先插入在聚焦
            let $txt = $folder.find('input');
            $txt.select();//选中聚焦
            $txt.blur(function(){
                //当失焦的时候把新的数据push到ary中，并且通过新的数据渲染页面
                let val = $txt.val();
                //看看是否重复命名
                let bool = ary.map
                (item=>item.title).includes(val);
                let nval = '';
                let num = 1;
                nval = val;//把input中value给最新的value（最新的value就是最后的结果）
                while(bool){
                    //如果重名了那么从1开始看有没有重名
                    let s = val.replace(/\(\d\)$/,'') + '('+ num++ +')';
                    bool = ary.map
                    (item=>item.title).includes(s);
                    nval = s;
                }
                ary.push({
                    id:+new Date,
                    title:nval
                });
                render(ary);
                return false;
            });//失焦事件
       });
  </script>
</body>
</html>